function [x,xi]=pseudogen3(n,fb,seed,ppdt)%% [x,xi]=pseudogen3(n,fb,seed,ppdt)%% Function to generate a pseudorandom ternary sequence.  The% number of shift registers is n (1x1), the feedback is defined% by fb (1xn), and starting values in the shift register are% given by seed (1xn) where seed has values of 0,1,or 2.%% For fb = [-1 1], then x(1) = rem(fb*seed',3), and if x(1)% is less than 0, the x(1) = x(1)+3.  For the final x output% substitute -1 for all 2 in the sequence.%% The vector xi contains the integration of x with ppdt "points% per delta t", i.e. each state of the shift register is divided% into ppdt intervals and the integration is computed at each of the% points.  %shiftreg=seed;i=3^n-1;  % length of ternary sequencex=zeros(1,i);for j=1:i  x(j)=rem(fb*shiftreg',3);  if x(j)<0    x(j)=x(j)+3;  end  shiftreg=[x(j) shiftreg(1:(n-1))];  % shift to rightendfor j=1:i		%assign -1 to 2  if x(j)==2    x(j)=-1;  endend%% integrate the sequence%xi=zeros(1,ppdt*i);for j=1:i  for jj=1:ppdt    xi(jj+(j-1)*ppdt+1)=xi(jj+(j-1)*ppdt)+x(j);  endendxi=xi(1:ppdt*i); % get rid of last pt which repeats first pt